# DOD: 삼성생명 e-Partner 업무 자동화 (Daily Contract Update)

## 1. 개요 (Overview)
삼성생명 영업지원 시스템(e-Partner)에 매일 접속하여, 당월 '계약일자별' 데이터를 조회하고 엑셀 파일로 다운로드하는 **완전 자동화(RPA)** 시스템입니다. 단순 반복 업무를 제거하고 데이터 관리의 효율성을 높이기 위해 개발되었습니다.

## 2. 주요 기능 (Key Features)
- **자동 실행 및 로그인**: 
  - `XPlatform`을 자동으로 실행하고 ID/PW를 입력합니다.
  - "이미 로그인되었습니다" 중복 로그인 팝업을 자동으로 감지하고 처리합니다.
- **조건부 데이터 조회**:
  - 자동으로 '이번 달 1일'부터 '오늘'까지의 날짜를 계산하여 조회 조건을 설정합니다.
- **엑셀 다운로드 및 저장**:
  - 조회된 데이터를 엑셀로 내보냅니다 (사유 입력: 'upmuyong').
  - 엑셀이 열리면 `F12` (다른 이름으로 저장) 단축키를 이용해 지정된 경로에 파일을 저장합니다.
  - 엑셀 종료 시 발생하는 "저장하시겠습니까?" 팝업까지 자동으로 처리(`Enter`)합니다.
- **파일 관리**:
  - 저장 경로: `g:\내 드라이브\안티그래비티\TEST\계약관리(일자별)`
  - 파일명 형식: `YYYYMMDD_HHMMSS_계약일자별조회.xlsx`

## 3. 기술 스택 (Tech Stack)
- **Language**: Python 3.12
- **Libraries**:
  - `pyautogui`: 마우스/키보드 제어 및 이미지 인식 (좌표 기반 클릭)
  - `pywinauto`: 윈도우 애플리케이션 제어 (창 활성화, 포커스)
  - `pyperclip`: 한글 파일 경로 복사/붙여넣기 지원
  - `subprocess`, `os`: 외부 프로세스 실행 및 종료 관리

## 4. 실행 방법 (How to Run)
1. **가상환경 진입 (선택 사항)**
   ```powershell
   # 가상환경이 rpa_venv인 경우
   .\rpa_venv\Scripts\activate
   ```

2. **스크립트 실행**
   ```powershell
   # 프로젝트 루트 또는 execution 폴더에서 실행
   python execution/full_automation.py
   ```
   *(주의: 실행 중에는 마우스나 키보드를 조작하지 마세요. 화면 해상도나 배율이 변경되면 좌표 수정이 필요할 수 있습니다.)*

## 5. 구현 상세 (Implementation Details)
- **좌표 기반 제어**: 사용자 환경에 맞춰 주요 버튼(계약, 조회, 엑셀 등)의 좌표(`POS_...`)를 하드코딩하여 정확도를 높였습니다.
- **안전 장치**:
  - 기존 실행 중인 `XPlatform.exe`를 강제 종료하여 클린 상태에서 시작합니다.
  - 엑셀 저장 시 `pyperclip`을 사용하여 한글 경로 깨짐을 방지했습니다.
  - `time.sleep()`을 적절히 배치하여 프로그램 로딩 및 팝업 대기 시간을 확보했습니다.

## 6. 유지보수 가이드 (Maintenance)
- **좌표 수정**: 모니터 해상도가 바뀌거나 UI 위치가 변경될 경우, `full_automation.py` 상단의 `POS_` 변수들을 수정해야 합니다. (`capture_screen.py` 또는 `find_windows.py` 활용)
- **계정 정보**: `USER_ID`, `USER_PW`가 변경되면 스크립트 내 변수를 업데이트하세요.

---
**작성일**: 2026-02-19
**작성자**: Antigravity (AI Agent)
